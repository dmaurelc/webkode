---
const links = [
  { name: "Servicios", href: "#servicios" },
  { name: "Portafolio", href: "#proyectos" },
  { name: "FAQ", href: "#faq" },
  { name: "Contacto", href: "#agendar" },
];
---

<header
  id="main-header"
  class="fixed top-0 left-0 w-full h-20 bg-black/95 backdrop-blur-sm border-b border-white/5 flex items-center px-6 md:px-10 z-[9998] transition-all duration-300"
>
  <div class="flex items-center justify-between w-full h-full lg:justify-start">
    <!-- LADO IZQUIERDO: Gatillo Menú (Sólo móvil) -->
    <button
      id="v5-trigger"
      class="lg:hidden h-12 w-12 flex items-center justify-center bg-accent text-black active:scale-95 transition-transform"
      aria-label="Menu"
    >
      <div id="v5-icon-wrapper" class="relative w-6 h-5">
        <span
          id="v5-bar-1"
          class="absolute top-0 left-0 w-full h-0.5 bg-current transition-all duration-300"
        ></span>
        <span
          id="v5-bar-2"
          class="absolute top-2 w-full h-0.5 bg-current transition-all duration-300"
        ></span>
        <span
          id="v5-bar-3"
          class="absolute top-4 w-full h-0.5 bg-current transition-all duration-300"
        ></span>
      </div>
    </button>

    <!-- ESPACIADOR (Sólo móvil para empujar logo a la derecha) -->
    <div class="lg:hidden flex-1"></div>

    <!-- LOGO (Derecha en móvil, Izquierda en Desktop) -->
    <div class="flex items-center lg:mr-12">
      <a href="/" class="flex items-center gap-3">
        <div class="w-8 h-8 bg-white flex items-center justify-center">
          <span class="text-black font-black text-sm">W</span>
        </div>
        <span class="text-xl font-black tracking-tighter text-white uppercase"
          >webkode</span
        >
      </a>
    </div>

    <!-- NAVEGACIÓN DESKTOP -->
    <nav class="hidden lg:flex items-center gap-10">
      {
        links.map((link) => (
          <a
            href={link.href}
            class="text-[10px] uppercase tracking-[0.3em] font-black text-zinc-500 hover:text-white transition-colors"
          >
            {link.name}
          </a>
        ))
      }
    </nav>

    <!-- CTA DESKTOP -->
    <div class="hidden lg:flex ml-auto items-center">
      <a
        href="#agendar"
        class="h-20 flex items-center px-10 bg-white hover:bg-accent text-black transition-colors font-black text-[11px] uppercase tracking-[0.3em]"
      >
        Start Project
      </a>
    </div>
  </div>
</header>

<!-- MENÚ MÓVIL (Offcanvas) -->
<div
  id="v5-mobile-menu"
  class="fixed top-0 left-0 w-full h-full z-9999 pointer-events-none invisible"
>
  <!-- Backdrop -->
  <div
    id="v5-backdrop"
    class="absolute inset-0 bg-black/80 opacity-0 transition-opacity duration-500"
  >
  </div>

  <!-- Content Panel -->
  <div
    id="v5-panel"
    class="absolute top-0 left-0 w-full h-full bg-black border-r border-white/10 transition-transform duration-500 flex flex-col pt-32 px-10 pointer-events-auto"
  >
    <div class="mb-12">
      <span
        class="text-[10px] font-black tracking-[0.5em] uppercase text-zinc-700"
        >Explore</span
      >
    </div>

    <nav class="flex flex-col gap-8">
      {
        links.map((link, i) => (
          <a
            href={link.href}
            class="v5-link text-4xl font-black text-white uppercase tracking-tighter hover:text-accent flex items-baseline gap-4"
          >
            <span class="text-xs font-mono text-accent/40">0{i + 1}</span>
            {link.name}
          </a>
        ))
      }
    </nav>

    <div class="mt-auto py-12 border-t border-white/5 flex flex-col gap-8">
      <div
        class="flex flex-col gap-2 text-[10px] uppercase tracking-widest text-white/60"
      >
        <span>Los Andes / Chile</span>
        <span>webkode.cl</span>
      </div>
    </div>
  </div>
</div>

<script>
  const trigger = document.getElementById("v5-trigger");
  const menu = document.getElementById("v5-mobile-menu");
  const backdrop = document.getElementById("v5-backdrop");
  const panel = document.getElementById("v5-panel");
  const bar1 = document.getElementById("v5-bar-1");
  const bar2 = document.getElementById("v5-bar-2");
  const bar3 = document.getElementById("v5-bar-3");
  const links = document.querySelectorAll(".v5-link");

  let isOpen = false;

  function toggle() {
    if (!menu || !backdrop || !panel || !bar1 || !bar2 || !bar3) return;

    isOpen = !isOpen;

    if (isOpen) {
      menu.classList.remove("invisible");
      menu.classList.add("pointer-events-auto");
      backdrop.classList.add("opacity-100");
      panel.style.transform = "translateX(0)";

      bar1.style.transform = "translateY(8px) rotate(45deg)";
      bar2.style.opacity = "0";
      bar3.style.transform = "translateY(-8px) rotate(-45deg)";

      document.body.style.overflow = "hidden";
    } else {
      backdrop.classList.remove("opacity-100");
      panel.style.transform = "translateX(-100%)";

      bar1.style.transform = "translateY(0) rotate(0)";
      bar2.style.opacity = "1";
      bar3.style.transform = "translateY(0) rotate(0)";

      setTimeout(() => {
        if (!isOpen) {
          menu.classList.add("invisible");
          menu.classList.remove("pointer-events-auto");
        }
      }, 500);

      document.body.style.overflow = "";
    }
  }

  trigger?.addEventListener("click", toggle);
  backdrop?.addEventListener("click", toggle);
  links.forEach((l) => l.addEventListener("click", () => isOpen && toggle()));

  // Scroll Header
  window.addEventListener("scroll", () => {
    const h = document.getElementById("main-header");
    if (h && !isOpen) {
      h.classList.toggle("h-16", window.scrollY > 50);
      h.classList.toggle("h-20", window.scrollY <= 50);
    }
  });
</script>

<style>
  /* Robustez CSS */
  #v5-panel {
    box-shadow: 20px 0 50px rgba(0, 0, 0, 0.5);
  }
</style>
